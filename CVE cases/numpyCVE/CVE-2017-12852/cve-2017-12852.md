# CVE-2017-12852
Numpy

DOS attack

Function numpy.pad does not have input validation on the input variable array. 

In the below code, safe_pad = -1 because the input is an empty array. pad_iter_b and pad_iter_ad will always be a negative integer. so the safe_pad will add two negative integer (pad_iter_a and pad_iter_b) and become smaller. While pad_before and pad_after will minus two negative integer (pad_iter_a and pad_iter_b) and become bigger. So the loop condition **pad_before > safe_pad or pad_after > safe_pad** will always be satisfied and cause a DOS.

Related Vulberable code
```Python
def pad(array, pad_width, mode, **kwargs):
    narray = np.array(array)
    newmat = narray.copy()
    safe_pad = newmat.shape[axis] - 1 # the value of safe_pad is -1 when input is an empty array
    for axis, (pad_before, pad_after) in enumerate(pad_width): # pad_before and pad_after are positive integers
        while ((pad_before > safe_pad) or (pad_after > safe_pad)): # pad_before and pad_after will always be positive and safe pad will always be negative so the loop will never stop
            pad_iter_b = min(safe_pad, safe_pad * (pad_before // safe_pad)) # pad_iter_b is a negative integer
            pad_iter_a = min(safe_pad, safe_pad * (pad_after // safe_pad)) # pad_iter_a is a negative integer
            pad_before -= pad_iter_b # pad_before will minus a negative integer so it will always > 0
            pad_after -= pad_iter_a # pad_after will minus a negative integer so it will always > 0
            safe_pad += pad_iter_b + pad_iter_a # safe_pad keep add two negative integer so it will always < 0
```