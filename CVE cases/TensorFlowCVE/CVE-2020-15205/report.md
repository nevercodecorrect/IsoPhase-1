# CVE-2020-15205
TensorFlow

the `data_splits` argument of `tf.raw_ops.StringNGrams` lacks validation. 

Attackers can pass values that can cause heap overflow errors and even leak contents of memory 

In the linked code snippet, all the binary strings after `ee ff` are contents from the memory stack. Since these can contain return addresses, this data leak can be used to defeat ASLR. 

Patched Code
```C
void Compute(tensorflow::OpKernelContext* context) override {
    // patched code Validate that the splits are valid indices into data
    const int input_data_size = data->flat<tstring>().size();
    const int splits_vec_size = splits_vec.size();
    for (int i = 0; i < splits_vec_size; ++i) {
      bool valid_splits = splits_vec(i) >= 0;
      valid_splits = valid_splits && (splits_vec(i) <= input_data_size);
      OP_REQUIRES(
          context, valid_splits,
          errors::InvalidArgument("Invalid split value ", splits_vec(i),
                                  ", must be in [0,", input_data_size, "]"));
    }
}
