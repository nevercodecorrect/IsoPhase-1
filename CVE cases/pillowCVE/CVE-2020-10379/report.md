# CVE-2020-10379
Pillow

two Buffer Overflows can be triggered by crafted tiff image in libImaging/TiffDecode.c.

patched code
```C
int ImagingLibTiffDecode(Imaging im, ImagingCodecState state, UINT8* buffer, Py_ssize_t bytes) {
    if (TIFFTileSize(tiff) > state->bytes) {
        // If the strip size as expected by LibTiff isn't what we're expecting, abort.
        state->errcode = IMAGING_CODEC_MEMORY;
        TIFFClose(tiff);
        return -1;
    }
    if (TIFFStripSize(tiff) > state->bytes) {
    // If the strip size as expected by LibTiff isn't what we're expecting, abort.
    // man:   TIFFStripSize returns the equivalent size for a strip of data as it would be returned in a
    //        call to TIFFReadEncodedStrip ...
    state->errcode = IMAGING_CODEC_MEMORY;
    TIFFClose(tiff);
    return -1;
    }

}
```